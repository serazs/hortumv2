local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

local LocalPlayer = Players.LocalPlayer

-- Karakterin yüklenmesini bekle
local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

-- Tüm part'leri topla
local parts = {}
local function addPart(part)
    if part:IsA("BasePart") and not part.Anchored and part:IsDescendantOf(Workspace) then
        -- Karakterin kendi part'lerini alma
        if part:IsDescendantOf(LocalPlayer.Character) then return end
        table.insert(parts, part)
    end
end

for _, part in pairs(Workspace:GetDescendants()) do
    addPart(part)
end

Workspace.DescendantAdded:Connect(addPart)

-- Her part için bir açı ve hız
local partData = {}
local radius = 40
local height = 30
local speed = 2
local attraction = 1000

-- Kalp noktası hesapla (içi boş kalp çizgisi)
local function getHeartPoint(t, center, scale)
    local s = scale / 12
    local x = 16 * math.sin(t)^3 * s
    local z = (13 * math.cos(t) - 5 * math.cos(2*t) - 2 * math.cos(3*t) - math.cos(4*t)) * s
    return Vector3.new(center.X + x, center.Y, center.Z + z)
end

-- Animasyon döngüsü
RunService.Heartbeat:Connect(function()
    local center = humanoidRootPart.Position
    local time = tick()
    
    -- Yeni part'lar için veri oluştur
    for _, part in pairs(parts) do
        if not partData[part] and part.Parent then
            partData[part] = {
                angle = math.random() * 2 * math.pi,
                speed = 0.5 + math.random() * 1.5
            }
        end
    end
    
    -- Her part'ı hareket ettir
    for part, data in pairs(partData) do
        if part.Parent and not part.Anchored then
            -- Açıyı güncelle (dönme efekti)
            data.angle = data.angle + math.rad(speed * data.speed)
            if data.angle > 2 * math.pi then data.angle = data.angle - 2 * math.pi end
            
            -- Hedef noktayı hesapla (kalp üzerinde)
            local heartPoint = getHeartPoint(data.angle, center, radius)
            -- Yükseklik dalgalanması (isteğe bağlı)
            heartPoint = Vector3.new(heartPoint.X, center.Y + height * math.sin(time * 2 + data.angle), heartPoint.Z)
            
            -- Part'i hedefe çek
            local direction = (heartPoint - part.Position).unit
            part.Velocity = direction * attraction
        else
            partData[part] = nil -- part yoksa temizle
        end
    end
end)

-- Bildirim (isteğe bağlı)
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "Kalp Hortum",
    Text = "Aktif!",
    Duration = 3
})
